# 방 투시 레이아웃 PRD

(파란 사각형 + 빨간 사각형 + 연결선)

## 0. 개요

* 화면에는 두 개의 사각형으로 구성된 **방 투시도 레이아웃**을 사용한다.

  * **파란 사각형(외곽 프레임)**: 고정된 방의 틀.
  * **빨간 사각형(정면 벽)**: 실제 시스템 선반·기둥이 배치될 작업 영역.
* 두 사각형의 각 꼭짓점은 **검은 선**으로 연결되어,
  사용자가 보기에는 **직육면체 방을 정면에서 본 투사도**처럼 보이게 한다.
* 방의 크기(폭/높이)는 사용자가 **mm 단위로 입력**하며,
  파란 사각형은 고정이고 **빨간 사각형 크기만 변한다**.
  검은 선은 항상 두 사각형의 꼭짓점을 자동으로 따라간다.

> 이 레이아웃 위에서 이후 **시스템 기둥/선반 배치 기능**이 구현될 예정이다.

---

## 1. 요소 정의

### 1.1 파란 사각형 (Blue Frame)

* 역할: 방의 외곽 프레임, 고정된 기준 틀.
* 특징:

  * **크기·위치 불변** (화면 해상도에 맞춰 최초 한 번 계산 후 고정).
  * 화면에서 방 전체를 둘러싸는 바깥 사각형.
* 꼭짓점:

  * `B1`: 좌상단(Top Left)
  * `B2`: 우상단(Top Right)
  * `B3`: 우하단(Bottom Right)
  * `B4`: 좌하단(Bottom Left)

### 1.2 빨간 사각형 (Red Front Wall)

* 역할: 실제 선반/기둥을 배치하는 **정면 벽 작업 영역**.
* 특징:

  * **파란 사각형 내부에 위치**.
  * 방 폭/높이(mm) 값에 따라 **가로·세로 크기가 변함**.
  * 항상 파란 사각형 기준 **수평/수직 중앙 정렬**.
* 꼭짓점:

  * `R1`: 좌상단
  * `R2`: 우상단
  * `R3`: 우하단
  * `R4`: 좌하단

### 1.3 연결선 (Black Connecting Lines)

* 역할: 파란 프레임과 빨간 정면 벽을 연결하여 **3D 방처럼 보이게 하는 시각 효과**.
* 연결 규칙:

  * `B1 ↔ R1`
  * `B2 ↔ R2`
  * `B3 ↔ R3`
  * `B4 ↔ R4`
* 특징:

  * 별도의 상태를 가지지 않고, **항상 B와 R의 현재 좌표를 이용해 다시 그림**.

---

## 2. 데이터/상태 (개념)

* `roomWidthMm` : 방 폭 (사용자 입력, mm)
* `roomHeightMm`: 방 높이 (사용자 입력 or 기본값, mm)
* `blueRect` : 파란 사각형 화면 좌표 `{ x, y, width, height }` (고정)
* `redRect`  : 빨간 사각형 화면 좌표 `{ x, y, width, height }` (입력에 따라 변함)
* `scale`    : mm → px 변환 비율 (캔버스 크기에 따라 계산)

※ 기둥/선반 기능은 이 `roomWidthMm`, `roomHeightMm`, `redRect`, `scale` 를 기준으로 좌표를 계산함.

---

## 3. 기능 요구사항 (Functional Requirements)

### 3.1 파란 사각형 렌더링

1. 앱/화면 로드 시:

   * 캔버스 크기 기준으로 `blueRect` 한 번 계산.
   * 예: 캔버스의 가로·세로 90% 정도를 차지하도록 설정.
2. 이후 방 크기를 변경해도 `blueRect`는 **변하지 않는다**.

### 3.2 방 크기 입력 (mm)

1. 사용자 입력 필드:

   * `폭 (mm)` : `roomWidthMm`
   * `높이 (mm)` : `roomHeightMm`
2. 입력값 검증:

   * 숫자/양수 여부 체크.
   * 최소/최대 범위 (예: 폭 1200~6000mm, 높이 2000~3000mm) 내인지 확인.
   * 범위 밖이면 에러 메시지 또는 자동 보정.

### 3.3 빨간 사각형 크기/위치 계산

1. 스케일 계산:

   * `scaleX = blueRect.width  / roomWidthMm`
   * `scaleY = blueRect.height / roomHeightMm`
   * `scale  = min(scaleX, scaleY) * marginFactor`
     (marginFactor 예: 0.6~0.8, 파란 사각형 안에 여백을 남김)
2. 빨간 사각형 크기:

   * `redWidthPx  = roomWidthMm  * scale`
   * `redHeightPx = roomHeightMm * scale`
3. 빨간 사각형 위치(중앙 정렬):

   * `redRect.x = blueRect.centerX - redWidthPx  / 2`
   * `redRect.y = blueRect.centerY - redHeightPx / 2`
4. 방 크기 입력값이 바뀔 때마다 위 과정을 다시 수행하여 `redRect` 갱신.

### 3.4 연결선 그리기

1. 각 프레임 업데이트 시(처음 렌더링, 방 크기 변경 등):

   * 파란 사각형 꼭짓점 `B1~B4`, 빨간 사각형 꼭짓점 `R1~R4`를 계산.
2. 다음 네 개의 직선 그리기:

   * `B1 → R1`, `B2 → R2`, `B3 → R3`, `B4 → R4`.
3. 별도 로직 없이 항상 **현재 좌표를 기준**으로 다시 그리므로,

   * 빨간 사각형이 커지거나 작아져도
     연결선이 자동으로 모서리를 따라간다.

### 3.5 시각적 결과 요구사항

1. **폭 3000mm 방**을 입력했을 때:

   * 빨간 사각형의 폭이 상대적으로 좁고,
   * 검은 선이 많이 기울어져 “좁은 방”처럼 보인다.
2. **폭 5000mm 방**을 입력했을 때:

   * 빨간 사각형 폭이 눈에 띄게 넓어지고,
   * 검은 선이 수평에 가까워져 “넓은 방” 느낌이 난다.
3. 두 경우 모두:

   * 파란 프레임은 동일한 크기/위치를 유지한다.

---

## 4. 예외 및 제약

* 너무 큰 방(예: 8000mm 이상)을 넣어도 빨간 사각형이 파란 사각형 밖으로 나가면 안 된다.

  * → 스케일/최대 폭 mm 제한을 통해 제어.
* 너무 작은 방(예: 500mm)도 최소 mm 제한 또는 최소 px(예: 100px)로 강제.
* 창/해상도 변경 시:

  * `blueRect`와 `scale`, `redRect`를 다시 계산하여
    **방 전체가 항상 뷰 안에 자연스럽게 보이도록** 조정.

---

## 5. 한 줄 요약

> **파란 사각형은 고정된 방 프레임, 빨간 사각형은 방 크기(mm)에 따라 변하는 정면 벽이며, 두 사각형의 각 꼭짓점을 검은 선으로 연결해 항상 “직사면체 방”처럼 보이게 만든다. 방 크기를 바꿔도 파란 프레임은 그대로 있고, 빨간 사각형 크기와 연결선만 자동으로 업데이트된다.**
